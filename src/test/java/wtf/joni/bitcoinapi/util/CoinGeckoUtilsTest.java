package wtf.joni.bitcoinapi.util;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static wtf.joni.bitcoinapi.util.CoinGeckoUtils.resolveDailyItems;

public class CoinGeckoUtilsTest {

    @Test
    public void resolveDaily() throws Exception {
        ObjectMapper mapper = new ObjectMapper();
        String jsonString = "[[1579392282472,8030.890983244613],[1579395636425,8061.866686145643],[1579399224455,8216.007975520393],[1579402947092,8226.919957354903],[1579406656525,8222.886116541908],[1579410238441,8224.239650565496],[1579413649681,8205.911010111877],[1579417363081,8157.152361113717],[1579420944875,8177.97227737549],[1579424664495,8173.871144747667],[1579428263387,8156.109109794036],[1579431753802,8137.29057987931],[1579435244218,7814.583358700629],[1579439071133,7772.285650857634],[1579442695739,7780.630397108771],[1579446465950,7763.2178480007],[1579449948660,7789.6434302976095],[1579453478156,7787.825597817771],[1579457246499,7802.961650629347],[1579460576842,7790.654797462437],[1579464260876,7804.4072040483525],[1579467952204,7787.797157621186],[1579471537908,7851.879029063103],[1579475064912,7805.271071903182],[1579478664166,7833.230953209291],[1579482285138,7810.92627022683],[1579485914245,7798.302533029035],[1579489438453,7790.32623856723],[1579493092099,7788.020275311903],[1579496578451,7787.78138097779],[1579500330485,7810.065525411498],[1579503836326,7825.845942129215],[1579507444922,7802.655799216089],[1579511082950,7794.813452331958],[1579514705798,7800.292506325777],[1579518175056,7798.376771017796],[1579522060077,7778.046306055055],[1579525451764,7737.659839703671],[1579529162238,7750.97600170709],[1579532673500,7804.348014177352],[1579536453918,7825.263884875964],[1579539844678,7803.464807862253],[1579543390879,7793.165521487865],[1579547071121,7802.812384459461],[1579550751458,7809.89383182753],[1579554310481,7806.780963786536],[1579557970143,7815.779814198295],[1579561456292,7787.525179838164]]";

        JsonNode json = mapper.readTree(jsonString);
        String result = resolveDailyItems(json).toString();

        assertEquals("{1579392282472=8030.890983244613, 1579478664166=7833.230953209291}", result);
    }

}
